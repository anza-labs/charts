# yaml-language-server: $schema=https://raw.githubusercontent.com/helm-unittest/helm-unittest/main/schema/helm-testsuite.json
suite: Secret

templates:
  - secret.yaml

tests:
  - it: Should not create Secret
    set: {}
    asserts:
      - hasDocuments:
          count: 0

  - it: Should create Secret with provided values
    set:
      telemetry:
        create: true
        otlpEndpoint: https://otlp.test:4317
        otlpAuth: "Authorization: Bearer mytoken123"
        deploymentEnvironment: test
    asserts:
      - documentIndex: 0
        isKind:
          of: Secret
      - isSubset:
          path: stringData
          content:
            OTLP_ENDPOINT: "https://otlp.test:4317"
            OTLP_AUTH: "Authorization: Bearer mytoken123"
            DEPLOYMENT_ENVIRONMENT: "test"
